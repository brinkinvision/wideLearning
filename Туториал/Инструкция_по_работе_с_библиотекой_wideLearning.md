# 0 Установка и импорт библиотеки
1. Для установки библиотеки необходимо в терминале ввести следующую команду:
```
pip install widelearning
```
Также необходимо установить дополнительные библиотеки:
```
pip install numpy
```
```
pip install pandas
```
```
pip install requests
```
Для сверточного слоя необходимо установить библиотеку TensorFlow:
```
pip install tensorflow
```
Дальнейшие действия выполнены в Jupyter Notebook. Устанавливается с помощью команды:
```
pip install jupyter
```
Запуск Jupyter Notebook выполняется с помощью команды:
```
jupyter notebook
```
2. Импорт библиотеки:
```
import widelearning as wdl
```
# 1 Полносвязный слой
1. Подготовка набора данных (датасета).
Для примера использован набор данных User Knowledge Modeling Data Set, который можно скачать по адресу: 
[User Knowledge Modeling Data Set](https://archive.ics.uci.edu/ml/datasets/User+Knowledge+Modeling)

Открытый в MS Excel файл выглядит следующим образом:

![1_dense](img/modified_dense/1.png)

Скопируем часть, содержащую данные, в новый файл формата csv и переместим столбец UNS (состоит из меток принадлежности к классам) в начало. Заменим разделитель целой и дробной части вместо запятой «,» на точку «.». Также необходимо разделитель столбцов поменять с «;» на «,». Иногда данные в csv файле могут быть после преобразований заключены в двойные кавычки. Необходимо также удалить из итогового файла этот знак.
Получившийся файл, открытый в текстовом редакторе:

![2_dense](img/modified_dense/2.png)

2. Преобразование в целочисленный вид
Для выполнения вычислений преобразуем с помощью функции data_int представленные в вещественнозначном виде данные в целочисленный. Создадим файл dec.txt, который содержит количество знаков после запятой для каждого столбца файла csv. Значения количества знаков в файле txt идут на новой строке для каждого следующего столбца, то есть в нашем случае имеется 5 столбцов, для каждого столбца количество знаков равно 2. В итоге в файле dec.txt 5 строк со значением 2:

![3_dense](img/modified_dense/3.png)

Первый параметр функции – путь к подготовленной выборке в формате csv, второй параметр – файл со значениями количества знаков после запятой для каждого столбца, третий параметр – желаемое название выходных преобразованных в целочисленный вид файлов.
```
wdl.data_int('kahraman.csv', 'dec.txt', 'KAHRAMAN') 
```
![4_dense](img/modified_dense/4.png)
В результате применения функции data_int получим целочисленные обучающую и тестовую выборки:

![5_dense](img/modified_dense/5.png)

3. Первоначальное приближение первого нейрона
Используем функцию select_top для получения первоначального приближения первого нейрона:
```
wdl.select_top('KAHRAMAN_train.csv', 'UNS')
```
Здесь первый параметр – путь к обучающей выборке в целочисленном виде, второй параметр – название столбца с метками классов.
Вывод функции выглядит следующим образом:
```
Количество отсеченных сверху =  9
Количество НЕотсеченных сверху =  14
Количество отсеченных снизу =  8
Количество НЕотсеченных снизу =  201
===Нижняя категория:  High
СУММА отсеченных сверху и снизу =  17
TOP -  ['very_low']
OTHERS -  ['High', 'Low', 'Middle']
+++++++++++++++++++++++++
Количество отсеченных сверху =  10
Количество НЕотсеченных сверху =  44
Количество отсеченных снизу =  15
Количество НЕотсеченных снизу =  163
===Нижняя категория:  very_low
СУММА отсеченных сверху и снизу =  25
TOP -  ['High']
OTHERS -  ['very_low', 'Low', 'Middle']
+++++++++++++++++++++++++
Количество отсеченных сверху =  4
Количество НЕотсеченных сверху =  71
Количество отсеченных снизу =  7
Количество НЕотсеченных снизу =  150
===Нижняя категория:  High
СУММА отсеченных сверху и снизу =  11
TOP -  ['Low']
OTHERS -  ['very_low', 'High', 'Middle']
+++++++++++++++++++++++++
Количество отсеченных сверху =  0
Количество НЕотсеченных сверху =  80
Количество отсеченных снизу =  7
Количество НЕотсеченных снизу =  145
===Нижняя категория:  Low
СУММА отсеченных сверху и снизу =  7
TOP -  ['Middle']
OTHERS -  ['very_low', 'High', 'Low']
+++++++++++++++++++++++++
```
Переменная TOP обозначает целевой класс и соответсвенно, «Нижняя категория» - это противоположный класс, участвующий в отсечении.
Были также сгенерированы папки:

![6_dense](img/modified_dense/6.png)

Необходимо выбрать целевой класс. Выбор можно производить по разным критериям: 
* по сумме отсеченных сверху и снизу;
* по количеству отсеченных сверху;
* по количеству отсеченных снизу и так далее.

От выбора целевого класса зависит итоговая структура нейронной сети. В нашем случае целевой класс будет выбираться по сумме отсеченных экземпляров сверху и снизу. Таким образом, в качестве целевого на первом нейроне выступает класс «High», поскольку сумма отсеченных равна 25. Если мы хотим оставить полученные результаты без проведения градиентного уточнения вектора весов, то необходимо открыть соответствующую папку и скопировать в отдельный каталог файлы w.txt и train.csv, которые являются вектором весов первого нейрона и сокращенной выборкой для второго нейрона:

![7_dense](img/modified_dense/7.png)

